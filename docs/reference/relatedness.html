<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>SLiM method relatedness — relatedness • slimr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="SLiM method relatedness — relatedness"><meta property="og:description" content="Documentation for SLiM function relatedness, which is a method of the
SLiM class Individual.
Note that the R function is a stub, it does not do anything in R (except bring
up this documentation). It will only do
anything useful when used inside a slim_block function further
nested in a slim_script
function call, where it will be translated into valid SLiM code as part of a
full SLiM script."><meta property="og:image" content="https://rdinnager.github.io/slimr/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">slimr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Custom_vis.html">Custom Live Plotting for SLiM</a>
    </li>
    <li>
      <a href="../articles/simple_example_using_migration_and_fst.html">simple_example_using_migration_and_fst</a>
    </li>
    <li>
      <a href="../articles/installing_SLiM_for_slimr.html">How to Install SLiM for Use with slimr</a>
    </li>
    <li>
      <a href="../articles/simple_nucleotide_example.html">Simple Example of a Simulation using Nucleotides</a>
    </li>
    <li>
      <a href="../articles/slimrlang_intro.html">Introduction to slimr: Writing SLiM scripts from R</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rdinnager/slimr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>SLiM method relatedness</h1>
    <small class="dont-index">Source: <a href="https://github.com/rdinnager/slimr/blob/HEAD/R/slim_lang.R" class="external-link"><code>R/slim_lang.R</code></a></small>
    <div class="hidden name"><code>relatedness.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Documentation for SLiM function <code>relatedness</code>, which is a method of the
SLiM class <code><a href="Individual.html">Individual</a></code>.
Note that the R function is a stub, it does not do anything in R (except bring
up this documentation). It will only do
anything useful when used inside a <code><a href="slim_block.html">slim_block</a></code> function further
nested in a <code><a href="slim_script.html">slim_script</a></code>
function call, where it will be translated into valid SLiM code as part of a
full SLiM script.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">relatedness</span><span class="op">(</span><span class="va">individuals</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>individuals</dt>
<dd><p>An object of type Individual object. See details for
description.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of type float.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Documentation for this function can be found in the official
<a href="http://benhaller.com/slim/SLiM_Manual.pdf#page=652" class="external-link">SLiM manual: page
652</a>.</p>
<p>Returns a vector containing the degrees of relatedness between the
receiver and each of the individuals in individuals. The relatedness between A
and B is always 1.0 if A and B are actually the same individual; this facility
works even if SLiM's optional pedigree tracking is not enabled (in which case
all other relatedness values will be 0.0). Otherwise, if pedigree tracking is
turned on with initializeSLiMOptions(keepPedigrees=T), this method will use
the pedigree information described in section 24.7.1 to construct a relatedness
estimate. More specifically, this method uses all available pedigree information
from the grandparental and parental pedigree records of A and B to compute
an estimate of the degree of consanguinity between A and B. Siblings have a
relatedness of 0.5, as do parents to their children and vice versa; cousins have
a relatedness of 0.125; and so forth. If, according to the pedigree information
available, A and B have no blood relationship, the value returned is 0.0. Note
that the value returned by relatedness() is what is called the "coefficient
of relationship" between the two individuals (Wright, 1922; https://
doi.org/10.1086/279872), and ranges from 0.0 to 1.0. There is another commonly
used metric of relatedness, called the "kinship coefficient", that reflects the
probability of identity by descent between two individuals A and B. In general,
it is approximately equal to one-half of the coefficient of relationship; if
an approximate estimate of the kinship coefficient is acceptable, especially in
models in which individuals are expected to be outbred, you can simply divide
relatedness() by two. However, it should be noted that Wright's coefficient
of relationship is not a measure of the probability of identity by descent,
and so it is not exactly double the kinship coefficient; they actually
measure different things. More precisely, the relationship between them is
r = 2φ/sqrt((1+fA)(1+fB)), where r is Wright's coefficient of relatedness,
φ is the kinship coefficient, and fA and fB are the inbreeding coefficients
of A and B respectively. Note that this relatedness is simply pedigree-based
relatedness, and does not necessarily correspond to genetic relatedness, because
of the effects of factors like assortment and recombination. If a metric of
actual genetic relatedness is desired, tree-sequence recording can be used
after simulation is complete, to compute the exact genetic relatedness between
individuals based upon the complete ancestry tree (a topic which is beyond the
scope of this manual). Actual genetic relatedness cannot presently be calculated
during a simulation run; the information is implicitly contained in the recorded
tree-sequence tables, but calculating it is too computationally expensive to be
reasonable. This method makes a couple of assumptions. One assumption is that
the grandparents (or the parents, if grandparental information is not available)
are themselves unrelated and that they are not inbred; this assumption is
necessary because we have no information about their parentage, since SLiM's
pedigree tracking information only goes back two generations. Be aware that
in a model where inbreeding or selfing occurs at all (including "incidental
selfing", where a hermaphroditic individual happens to choose itself as a mate),
some level of "background relatedness" will be present and this assumption
will be violated. In such circumstances, relatedness() will therefore tend to
underestimate the degree of relatedness between individuals, and the greater
the degree of inbreeding, the greater the underestimation will be. If inbreeding
is allowed in a model - and particularly if it is common - the results
of relatedness() should therefore not be taken as an estimate of absolute
relatedness, but can still be useful as an estimate of relative relatedness
(indicating that, say, A appears from the information available to be more
closely related to B than it is to C). A second assumption is that, in nonWF
models, addRecombinant() is not being used, since the pedigree relationships
involved are then too complex to trace. Indeed, addRecombinant() does not
record pedigree information at all, for this reason, and so the relatedness of
individuals produced by addRecombinant() will be 0.0.</p>
    </div>
    <div id="copyright">
    <h2>Copyright</h2>
    

<p>This is documentation for a function in the SLiM software, and has been
reproduced from the official manual,
which can be found here: <a href="http://benhaller.com/slim/SLiM_Manual.pdf" class="external-link">http://benhaller.com/slim/SLiM_Manual.pdf</a>. This
documentation is
Copyright © 2016-2020 Philipp Messer. All rights reserved. More information
about SLiM can be found
on the official website: <a href="https://messerlab.org/slim/" class="external-link">https://messerlab.org/slim/</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other Individual: 
<code><a href="Individual.html">In</a></code>,
<code><a href="containsMutations.html">containsMutations</a>()</code>,
<code><a href="countOfMutationsOfType.html">countOfMutationsOfType</a>()</code>,
<code><a href="setSpatialPosition.html">setSpatialPosition</a>()</code>,
<code><a href="sumOfMutationsOfType.html">sumOfMutationsOfType</a>()</code>,
<code><a href="uniqueMutationsOfType.html">uniqueMutationsOfType</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Benjamin C Haller (<a href="mailto:bhaller@benhaller.com">bhaller@benhaller.com</a>) and Philipp W Messer
(<a href="mailto:messer@cornell.edu">messer@cornell.edu</a>)</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Russell Dinnage, Stephen Sarre, Bernd Gruber, Richard Duncan.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

